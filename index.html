<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Cannabis at the Workplace Risk Assessment Tool - Evaluate job safety sensitivity">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Cannabis at the Workplace Risk Assessment Tool</title>
    
    <!-- External Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
    
    <!-- CSS Stylesheet -->
    <link rel="stylesheet" href="styles.css">
    
    <!-- JavaScript -->
    <script src="script.js" defer></script>
</head>
<body>
    <header>
        <img src="logo.png" alt="Company Logo" width="80" height="80">
        <h1>Cannabis at the Workplace Risk Assessment Tool</h1>
    </header>

    <main class="container">
        <!-- Introduction Sections -->
        <section class="intro-section">
            <h2>Purpose</h2>
            <p>This tool helps organisations evaluate the safety sensitivity of specific jobs or job types in light of cannabis usage, ensuring compliance with South African laws such as the Occupational Health and Safety Act, Labour Relations Act and case law like the <em>Enever v Barloworld</em> judgement. It enables employers to classify jobs and job types into risk categories so that the three major determinants of how to deal with employees are enabled with specific focus on the safety sensitivity component.</p>
        </section>

        <section class="intro-section">
            <h2>Procedure</h2>
            <p>The tool classifies roles based on safety sensitivity into various risk categories, using a structured framework to assess risks posed by cannabis use. It provides recommendations on the risk classification of a specific job or job type as well as gives a potential employment contract clause and suggestions on additional control measures that may be taken to mitigate risks.</p>
        </section>

        <section class="intro-section">
            <h2>Reason</h2>
            <p>Latest Legislation and Case Law suggests that the following three factors need to be considered in combination in determining appropriate measures: Traces, Impairment and Safety Sensitivity of the job. This tool focuses on Safety Sensitivity.</p>
        </section>

        <!-- Job Information Form -->
        <form id="job-info-form" class="info-form">
            <div class="form-section">
                <h3>Job Information</h3>
                <div class="input-group">
                    <label for="job-title">Job Title</label>
                    <input type="text" 
                           id="job-title" 
                           name="job-title" 
                           required 
                           aria-required="true"
                           maxlength="100">
                </div>
                <div class="input-group">
                    <label for="department">Department</label>
                    <input type="text" 
                           id="department" 
                           name="department" 
                           required 
                           aria-required="true"
                           maxlength="100">
                </div>
                <div class="input-group">
                    <label for="assessment-date">Assessment Date</label>
                    <input type="date" 
                           id="assessment-date" 
                           name="assessment-date" 
                           required 
                           aria-required="true">
                </div>
            </div>
        </form>

        <!-- Risk Assessment Form -->
        <form id="risk-form" novalidate>
            <h2>Risk Assessment Questionnaire</h2>
            <ol>
                <li>
                    <label for="q1">Does the job involve operating heavy machinery, vehicles, or equipment that could cause serious injury or damage if mishandled?</label>
                    <select id="q1" name="q1" required aria-required="true">
                        <option value="">Please select...</option>
                        <option value="0">Never</option>
                        <option value="1">Seldom</option>
                        <option value="3">Frequently</option>
                        <option value="5">Always</option>
                    </select>
                </li>

                <li>
                    <label for="q2">Does the role require handling hazardous substances, such as chemicals, explosives, or toxic materials?</label>
                    <select id="q2" name="q2" required aria-required="true">
                        <option value="">Please select...</option>
                        <option value="0">No</option>
                        <option value="5">Yes</option>
                    </select>
                </li>

                <li>
                    <label for="q3">Are there any job tasks that could result in severe consequences (holistic consequences such as injury, death or consequential business prejudice) if performed incorrectly or while impaired?</label>
                    <select id="q3" name="q3" required aria-required="true">
                        <option value="">Please select...</option>
                        <option value="0">No</option>
                        <option value="5">Yes</option>
                    </select>
                </li>

                <li>
                    <label for="q4">Does the job require working at heights, underground, or in confined spaces?</label>
                    <select id="q4" name="q4" required aria-required="true">
                        <option value="">Please select...</option>
                        <option value="0">No</option>
                        <option value="4">Yes</option>
                    </select>
                </li>

                <li>
                    <label for="q5">Is the employee exposed to extreme temperatures, noise levels, or other hazardous environmental conditions?</label>
                    <select id="q5" name="q5" required aria-required="true">
                        <option value="">Please select...</option>
                        <option value="0">No</option>
                        <option value="4">Yes</option>
                    </select>
                </li>

                <li>
                    <label for="q6">Are there any physical hazards present in the work environment that could cause harm to the employee or others?</label>
                    <select id="q6" name="q6" required aria-required="true">
                        <option value="">Please select...</option>
                        <option value="0">No</option>
                        <option value="4">Yes</option>
                    </select>
                </li>

                <li>
                    <label for="q7">Could an employee's impairment lead to life-threatening situations, serious injuries, or fatalities?</label>
                    <select id="q7" name="q7" required aria-required="true">
                        <option value="">Please select...</option>
                        <option value="0">No</option>
                        <option value="5">Yes</option>
                    </select>
                </li>

                <li>
                    <label for="q8">Is there a risk of significant property damage or financial loss if the employee is impaired while performing their duties?</label>
                    <select id="q8" name="q8" required aria-required="true">
                        <option value="">Please select...</option>
                        <option value="0">No</option>
                        <option value="5">Yes</option>
                    </select>
                </li>

                <li>
                    <label for="q9">Could an impaired employee's actions compromise the safety or well-being of co-workers, customers, or the general public?</label>
                    <select id="q9" name="q9" required aria-required="true">
                        <option value="">Please select...</option>
                        <option value="0">No</option>
                        <option value="5">Yes</option>
                    </select>
                </li>

                <li>
                    <label for="q10">Does the job require PPE usage and specific safety protocols, where improper use could lead to injury or illness?</label>
                    <select id="q10" name="q10" required aria-required="true">
                        <option value="">Please select...</option>
                        <option value="0">No</option>
                        <option value="5">Yes</option>
                    </select>
                </li>

                <li>
                    <label for="q11">Does the job require working in close proximity to moving machinery, equipment, or vehicles?</label>
                    <select id="q11" name="q11" required aria-required="true">
                        <option value="">Please select...</option>
                        <option value="0">No</option>
                        <option value="4">Yes</option>
                    </select>
                </li>

                <li>
                    <label for="q12">Is the employee exposed to electrical hazards, open flames, or other dangerous energy sources?</label>
                    <select id="q12" name="q12" required aria-required="true">
                        <option value="">Please select...</option>
                        <option value="0">No</option>
                        <option value="4">Yes</option>
                    </select>
                </li>

                <li>
                    <label for="q13">Does the work environment contain any potential trip, slip, or fall hazards that could cause injury?</label>
                    <select id="q13" name="q13" required aria-required="true">
                        <option value="">Please select...</option>
                        <option value="0">No</option>
                        <option value="4">Yes</option>
                    </select>
                </li>

                <li>
                    <label for="q14">Does the employee often work alone or without direct supervision for extended periods?</label>
                    <select id="q14" name="q14" required aria-required="true">
                        <option value="">Please select...</option>
                        <option value="0">No</option>
                        <option value="3">Yes</option>
                    </select>
                </li>

                <li>
                    <label for="q15">Is the employee responsible for making critical decisions independently that could impact safety or consequential business prejudice if performed incorrectly or while impaired?</label>
                    <select id="q15" name="q15" required aria-required="true">
                        <option value="">Please select...</option>
                        <option value="0">No</option>
                        <option value="3">Yes</option>
                    </select>
                </li>

                <li>
                    <label for="q16">Are there limited opportunities for co-workers or supervisors to identify and intervene if an employee is impaired while working?</label>
                    <select id="q16" name="q16" required aria-required="true">
                        <option value="">Please select...</option>
                        <option value="0">No</option>
                        <option value="3">Yes</option>
                    </select>
                </li>
            </ol>

            <div class="form-actions">
                <button type="submit" class="submit-button">
                    Calculate Risk Level
                    <span class="sr-only">Press to calculate risk assessment based on your answers</span>
                </button>
                <button type="reset" class="reset-button">
                    Reset Form
                    <span class="sr-only">Clear all form entries</span>
                </button>
            </div>
        </form>

        <!-- Results Container -->
        <div id="results-container" class="results-container" style="display: none" aria-live="polite">
            <div id="risk-result" class="risk-block" role="status"></div>
            <div id="contract-clause" class="result-section">
                <h3>Recommended Contract Clause</h3>
                <div id="clause-content"></div>
            </div>
            <div id="measures" class="result-section">
                <h3>Control Measures</h3>
                <div id="measures-content"></div>
            </div>

            <!-- Export Buttons -->
            <div class="export-buttons">
                <button type="button" class="export-button excel-button" aria-label="Export to Excel">
                    <span class="button-text">Export to Excel</span>
                    <div class="loading-spinner" aria-hidden="true"></div>
                </button>
                <button type="button" class="export-button pdf-button" aria-label="Export to PDF">
                    <span class="button-text">Export to PDF</span>
                    <div class="loading-spinner" aria-hidden="true"></div>
                </button>
            </div>
        </div>

        <!-- Error Modal -->
        <div id="error-modal" class="modal" role="dialog" aria-labelledby="error-title" aria-hidden="true">
            <div class="modal-content">
                <h3 id="error-title">Error</h3>
                <p id="error-message"></p>
                <button type="button" class="close" aria-label="Close error message">&times;</button>
            </div>
        </div>
    </main>

    <footer>
        <div class="footer-content">
            © 2024 Cannabis Workplace Risk Assessment Tool. All Rights Reserved.
        </div>
    </footer>
</body>
</html>